# Nginx reverse proxy for MCP (streamable HTTP)
# Replace <PUBLIC_IP> with your public IP or domain.
server {
    listen 80;
    server_name 165.84.140.76;

    # Foundry/APIM hits root; rewrite to /mcp on the backend.
    # Force Host header to local to avoid MCP host validation.
    location / {
        proxy_pass http://127.0.0.1:8080/mcp;
        proxy_http_version 1.1;
        proxy_set_header Host 127.0.0.1:8080;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_read_timeout 3600;
        proxy_buffering off;
        add_header Cache-Control no-cache;
    }
}
